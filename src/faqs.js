// src/faqs.js
// å‹åŸºæ³•å¸¸è¦‹å•é¡Œ + ç°¡å–®é—œéµå­—æ¯”å°

const faqs = [
  {
    id: "work_hours_basic",
    keywords: ["å·¥æ™‚", "ä¸Šç­æ™‚é–“", "æ¯å¤©ä¸Šç­", "æ¯é€±ä¸Šç­", "è¶…æ™‚"],
    question: "æ­£å¸¸å·¥æ™‚ä¸Šé™æ˜¯å¤šå°‘ï¼Ÿ",
    answer:
      "ä¸€èˆ¬æƒ…æ³ä¸‹ï¼Œå‹åŸºæ³•è¦å®šæ­£å¸¸å·¥æ™‚ç‚ºã€æ¯å¤©ä¸è¶…é 8 å°æ™‚ï¼Œæ¯é€±ä¸è¶…é 40 å°æ™‚ã€ã€‚å…¬å¸å¦‚æœè¦å®‰æ’è¶…éé€™å€‹ä¸Šé™ï¼Œé€šå¸¸å°±æœƒæ¶‰åŠåŠ ç­ï¼Œå¿…é ˆå¦å¤–ä¾è¦å®šçµ¦åŠ ç­è²»ã€‚",
    articles: ["å‹åŸºæ³•ç¬¬ 30 æ¢"],
    reference: "å‹å‹•éƒ¨å‹å‹•åŸºæº–æ³•æ¢æ–‡æŸ¥è©¢ï¼ˆæ­£å¸¸å·¥ä½œæ™‚é–“ç›¸é—œè¦å®šï¼‰ã€‚",
  },
  {
    id: "overtime_pay",
    keywords: ["åŠ ç­", "åŠ ç­è²»", "åŠ ç­æ™‚æ•¸", "å»¶é•·å·¥æ™‚"],
    question: "åŠ ç­è²»å¤§æ¦‚æ€éº¼ç®—ï¼Ÿ",
    answer:
      "ä¸€èˆ¬ä¾†èªªï¼Œåœ¨æ³•å®šæ­£å¸¸å·¥æ™‚ä¹‹å¤–çš„å»¶é•·å·¥æ™‚ï¼ˆåŠ ç­ï¼‰ï¼Œé›‡ä¸»æ‡‰ä¾å‹åŸºæ³•çµ¦ä»˜åŠ ç­è²»ï¼Œå¹³æ—¥åŠ ç­è‡³å°‘ä»¥å¹³å¸¸å·¥è³‡çš„ 1.33 å€èµ·ç®—ï¼Œè¶…éä¸€å®šæ™‚æ•¸å¾Œæœƒå†æé«˜å€ç‡ï¼›ä¼‘æ¯æ—¥å‡ºå‹¤ä¹Ÿæœ‰ä¸åŒè¨ˆç®—æ–¹å¼ã€‚å¯¦éš›è¨ˆç®—éœ€è¦çœ‹å·¥è³‡çµæ§‹èˆ‡å…¬å¸åˆ¶åº¦ã€‚",
    articles: ["å‹åŸºæ³•ç¬¬ 24 æ¢", "å‹åŸºæ³•ç¬¬ 32 æ¢"],
    reference:
      "å»ºè­°å‘å‹å·¥å±€æˆ–å‹å‹•éƒ¨ç¶²ç«™æŸ¥è©¢ã€åŠ ç­è²»è©¦ç®—ã€æˆ–ç›¸é—œèªªæ˜æ–‡ä»¶ï¼Œä»¥å–å¾—æœ€æ–°è¦å®šã€‚",
  },
  {
    id: "annual_leave",
    keywords: ["ç‰¹ä¼‘", "å¹´å‡", "ç‰¹åˆ¥ä¼‘å‡", "ä¼‘å‡å¤©æ•¸"],
    question: "ç‰¹ä¼‘ï¼ˆç‰¹åˆ¥ä¼‘å‡ï¼‰æ€éº¼ç®—ï¼Ÿ",
    answer:
      "å‹å·¥åœ¨åŒä¸€é›‡ä¸»è™•å·¥ä½œæ»¿ä¸€å®šå¹´è³‡å¾Œï¼Œä¾æ³•å¯ä»¥äº«æœ‰ç‰¹åˆ¥ä¼‘å‡ï¼Œä¾‹å¦‚å·¥ä½œæ»¿ 1 å¹´æœ‰ 3 å¤©ã€2 å¹´æœ‰ 7 å¤©ç­‰ã€‚å¯¦éš›å¤©æ•¸æœƒéš¨å¹´è³‡å¢åŠ è€Œä¸åŒï¼Œä¸”è‹¥æ˜¯ä¸­é€”é›¢è·æˆ–æœªä¼‘å®Œï¼Œé›‡ä¸»é€šå¸¸éœ€è¦ä¾æ³•çµ¦äºˆæŠ˜ç¾æˆ–ä¾è¦å®šè™•ç†ã€‚",
    articles: ["å‹åŸºæ³•ç¬¬ 38 æ¢"],
    reference: "å¯ä»¥åƒè€ƒå‹å‹•éƒ¨æ•´ç†çš„ã€ç‰¹åˆ¥ä¼‘å‡è¡¨ã€æˆ–ç·šä¸Šç‰¹ä¼‘å¤©æ•¸è©¦ç®—å·¥å…·ã€‚",
  },
  {
    id: "severance",
    keywords: ["è³‡é£", "é£æ•£è²»", "éè‡ªé¡˜é›¢è·", "è¢«è³‡é£", "è³‡é£è²»"],
    question: "è¢«è³‡é£æ™‚ï¼Œé£æ•£è²»æ€éº¼è¨ˆç®—ï¼Ÿ",
    answer:
      "è‹¥å‹å·¥æ˜¯ä¾å‹åŸºæ³•è¦å®šé­è³‡é£ï¼ˆéè‡ªé¡˜é›¢è·ï¼‰ï¼Œé›‡ä¸»é€šå¸¸é ˆä¾å¹´è³‡çµ¦äºˆé£æ•£è²»ã€‚æ–°åˆ¶å‹é€€ä¸‹ï¼Œä¸€èˆ¬æ˜¯ä»¥å¹³å‡å·¥è³‡ä¹˜ä»¥ä¸€å®šå¹´è³‡å€æ•¸ã€‚å¯¦å‹™ä¸Šé‚„è¦çœ‹å‹é€€æ–°èˆŠåˆ¶ã€å¹´è³‡è¨ˆç®—æ–¹å¼èˆ‡æ˜¯å¦ç¬¦åˆåˆæ³•è³‡é£äº‹ç”±ã€‚",
    articles: ["å‹åŸºæ³•ç¬¬ 11 æ¢", "å‹åŸºæ³•ç¬¬ 17 æ¢ ç­‰ç›¸é—œæ¢æ–‡"],
    reference: "å»ºè­°åŒæ™‚åƒè€ƒå‹å‹•éƒ¨ã€éè‡ªé¡˜é›¢è·ã€èˆ‡ã€é£æ•£è²»è©¦ç®—ã€ç›¸é—œè³‡è¨Šã€‚",
  },

  {
    id: "layoff_notice_period",
    keywords: ["è³‡é£", "é å‘Š", "å¤šä¹…å‰", "å¹¾å¤©å‰", "æå‰å‘ŠçŸ¥", "é å‘ŠæœŸ"],
    question: "å…¬å¸è³‡é£å“¡å·¥ï¼Œéœ€è¦å¤šä¹…å‰é å‘Šï¼Ÿ",
    answer: [
      "ä¾ã€Šå‹å‹•åŸºæº–æ³•ã€‹ç¬¬ 16 æ¢ï¼Œé›‡ä¸»è‹¥ä¾æ³•è³‡é£å‹å·¥ï¼Œè¦ä¾å¹´è³‡é•·çŸ­æå‰é å‘Šï¼š",
      "",
      "â€¢ æœªæ»¿ 3 å€‹æœˆï¼šç›®å‰æ³•è¦ç„¡å¼·åˆ¶é å‘Šå¤©æ•¸ï¼ˆä½†ä»æ‡‰æ³¨æ„åˆç†èªªæ˜èˆ‡ç¨‹åºï¼‰ã€‚",
      "â€¢ æ»¿ 3 å€‹æœˆæœªæ»¿ 1 å¹´ï¼šè‡³å°‘ **10 æ—¥å‰** é å‘Šã€‚",
      "â€¢ æ»¿ 1 å¹´æœªæ»¿ 3 å¹´ï¼šè‡³å°‘ **20 æ—¥å‰** é å‘Šã€‚",
      "â€¢ æ»¿ 3 å¹´ä»¥ä¸Šï¼šè‡³å°‘ **30 æ—¥å‰** é å‘Šã€‚",
      "",
      "è‹¥é›‡ä¸»æ²’æœ‰æå‰é å‘Šï¼Œå°±æ‡‰æ”¹ç™¼ç›¸ç•¶å¤©æ•¸çš„ã€Œé å‘Šå·¥è³‡ã€ã€‚é å‘ŠæœŸé–“å…§ï¼Œå‹å·¥ä¹Ÿå¯ä»¥è«‹å‡å»æ‰¾å·¥ä½œï¼ˆæ±‚è·å‡ï¼‰ï¼Œå·¥è³‡ç…§çµ¦ã€‚",
      "",
      "âš ï¸ æœ¬èªªæ˜ç‚ºä¸€èˆ¬æ€§æ•´ç†ï¼Œå¯¦å‹™ä¸Šä»å»ºè­°å°±å…·é«”æƒ…æ³å‘å‹å·¥å±€æˆ–å°ˆæ¥­æ³•å¾‹æœå‹™è«®è©¢ã€‚",
    ].join("\n"),
    articles: ["å‹åŸºæ³•ç¬¬ 16 æ¢"],
    reference: "æ•´ç†è‡ªå‹å‹•åŸºæº–æ³•ç¬¬ 16 æ¢é—œæ–¼è³‡é£é å‘ŠæœŸé–“èˆ‡é å‘Šå·¥è³‡ä¹‹è¦å®šã€‚",
  },

  {
    id: "resign_notice",
    keywords: ["é›¢è·", "é å‘Š", "é›¢è·é å‘Š", "æå‰å‘ŠçŸ¥", "æé›¢è·"],
    question: "æˆ‘è¦é›¢è·ï¼Œéœ€è¦æå‰å¤šä¹…å‘ŠçŸ¥å…¬å¸ï¼Ÿ",
    answer:
      "å‹å·¥ä¸»å‹•æå‡ºé›¢è·æ™‚ï¼Œå‹åŸºæ³•ä¸¦æ²’æœ‰åƒè³‡é£é‚£æ¨£æ˜æ–‡è¦å®šã€ä¸€å®šè¦æå‰å¹¾å¤©ã€ï¼Œä½†å¤šæ•¸æƒ…æ³ä¸‹æœƒåƒè€ƒå‹å‹•å¥‘ç´„æˆ–å…¬å¸å…§è¦ã€‚ç›¸å°åœ°ï¼Œå¦‚æœæ˜¯é›‡ä¸»è¦çµ‚æ­¢å‹å‹•å¥‘ç´„ï¼ˆè³‡é£ï¼‰ï¼Œå°±æœ‰æ˜ç¢ºçš„é å‘ŠæœŸé–“è¦å®šï¼Œä¾‹å¦‚å·¥ä½œ 3 å€‹æœˆä»¥ä¸Š 1 å¹´æœªæ»¿éœ€æå‰ 10 æ—¥ç­‰ã€‚",
    articles: ["å‹åŸºæ³•ç¬¬ 15 æ¢", "å‹åŸºæ³•ç¬¬ 16 æ¢ï¼ˆé›‡ä¸»çµ‚æ­¢å¥‘ç´„é å‘ŠæœŸé–“ï¼‰"],
    reference: "è‹¥æœ‰çˆ­è­°ï¼Œå»ºè­°ä¿ç•™æºé€šç´€éŒ„ä¸¦å‘å‹å·¥å±€æˆ–ç›¸é—œæ©Ÿé—œè«®è©¢ã€‚",
  },
];

// ç°¡å–®æ–‡å­—æ­£è¦åŒ–ï¼šå»æ‰ç©ºç™½ã€è½‰å°å¯«
function normalize(text) {
  if (!text) return "";
  return text.toLowerCase().replace(/\s+/g, "");
}

// æ‰¾å‡ºæœ€ç›¸é—œçš„ä¸€é¡Œ FAQ
// questionText = ä½¿ç”¨è€…è¼¸å…¥æ–‡å­—
export function findBestFaq(questionText) {
  if (!questionText) return null;

  const text = normalize(questionText);

  let best = null;
  let bestScore = 0;

  for (const faq of faqs) {
    let score = 0;

    if (Array.isArray(faq.keywords)) {
      for (const rawKw of faq.keywords) {
        const kw = normalize(rawKw);
        if (!kw) continue;

        if (text.includes(kw)) {
          score += 1;
        }
      }
    }

    if (score > bestScore) {
      bestScore = score;
      best = faq;
    }
  }

  // âš ï¸ é‡é»åœ¨é€™è£¡ï¼šè‡³å°‘è¦å‘½ä¸­ 2 å€‹é—œéµå­—æ‰ç®— FAQ æœ‰ä¸­
  if (!best || bestScore < 2) {
    return null;
  }

  return best;
}
// æŠŠ FAQ çµ„æˆä¸€æ®µé©åˆåœ¨ LINE é¡¯ç¤ºçš„æ–‡å­—
export function formatFaqReply(userText, faq) {
  return [
    "ğŸ‘‹ ä½ å•çš„æ˜¯ï¼š",
    userText,
    "",
    "ğŸ” æˆ‘æ‰¾åˆ°ä¸€å€‹å¯èƒ½ç›¸é—œçš„ä¸»é¡Œï¼š",
    `ã€Œ${faq.question}ã€`,
    "",
    "ğŸ“Œ ç™½è©±èªªæ˜ï¼š",
    faq.answer,
    "",
    "ğŸ“– ç›¸é—œæ³•æ¢ï¼ˆåƒ…ä¾›åƒè€ƒï¼‰ï¼š",
    faq.articles.join("ã€"),
    "",
    faq.reference ? `â„¹ï¸ å»¶ä¼¸èªªæ˜ï¼š${faq.reference}` : "",
    "",
    "âš ï¸ æé†’ï¼šä»¥ä¸Šç‚ºä¸€èˆ¬æ€§èªªæ˜ï¼Œå¯¦éš›ä»éœ€ä¾å€‹æ¡ˆæƒ…æ³èˆ‡ä¸»ç®¡æ©Ÿé—œè§£é‡‹ç‚ºæº–ã€‚",
  ]
    .filter(Boolean)
    .join("\n");
}
